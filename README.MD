# Bitcoin Prediction System

Questo progetto implementa un sistema distribuito e containerizzato per la previsione del prezzo del Bitcoin, utilizzando una pipeline basata su microservizi con Kafka, Docker e modelli di Machine Learning.

## Architettura dei Servizi

Ogni servizio ha un ruolo ben definito nella pipeline:

---

### ğŸ“ `data-fetcher/`
- **Scopo**: Raccoglie dati grezzi da API esterne (es. CoinGecko).
- **Output**: Pubblica i dati grezzi su Kafka (topic `raw-data`).

---

### ğŸ“ `data-preprocessor/`
- **Scopo**: Pulisce e trasforma i dati per il modello ML.
- **Input**: Dati da `data-fetcher`.
- **Output**: Pubblica i dati preprocessati su Kafka (topic `cleaned-data`).

---

### ğŸ“ `model-trainer/`
- **Scopo**: Allena un modello ML sui dati preprocessati.
- **Output**: Salva il modello in `models/` (formato `.h5`, `.pkl`, ecc).

---

### ğŸ“ `predictor/`
- **Scopo**: Usa il modello allenato per fare predizioni.
- **Output**: Invia predizioni a Kafka (topic `predictions`).

---

### ğŸ“ `analysis-service/`
- **Scopo**: Analizza le predizioni e decide se generare un alert.
- **Output**: Invia messaggi su un topic di alert o triggera notifiche.

---

### ğŸ“ `notifier-service/`
- **Scopo**: Invia notifiche (es. Telegram) quando riceve un alert.
- **Input**: Messaggi da Kafka (`alerts`).
- **Configurazione**: Supporta piÃ¹ `TELEGRAM_CHAT_IDS`, separati da virgola.

---

### ğŸ“ `models/`
- **Scopo**: Volume condiviso tra `model-trainer` e `predictor` per contenere i modelli ML.

---

## Avvio e Stop del Sistema

### â–¶ï¸ Start
```bash
./start.sh
```

### â¹ï¸ Stop
```bash
./stop.sh
```

## Ambiente Docker
- I servizi sono definiti nel file `docker-compose.yml`
- Kafka e Zookeeper sono utilizzati per l'orchestrazione degli eventi tra servizi
- I servizi personalizzati (`data-fetcher`, `model-trainer`, ecc.) sono containerizzati via Dockerfile

## Variabili d'Ambiente Importanti
- `TELEGRAM_TOKEN`: token del bot Telegram
- `TELEGRAM_CHAT_IDS`: lista di chat ID separati da virgola (es. `-100124,-10058`)

## Requisiti
- Docker + Docker Compose
- Connessione Internet per il fetch dei dati


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BinanceDataFetcherService   â”‚
â”‚ - Recupera i dati BTCUSDT   â”‚
â”‚   da Binance (candlestick)  â”‚
â”‚ - Invia i dati al topic:    â”‚
â”‚   "bitcoin_data"            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   DataPreprocessor Service  â”‚
â”‚ - Consuma i dati dal topic  â”‚
â”‚   "bitcoin_data"            â”‚
â”‚ - Esegue preprocessing:     â”‚
â”‚   â€¢ Calcolo indicatori      â”‚
â”‚     tecnici (MA, volatilitÃ , â”‚
â”‚       returns, ecc.)        â”‚
â”‚   â€¢ Creazione di sequenze   â”‚
â”‚     per LSTM                â”‚
â”‚ - Pubblica i dati processatiâ”‚
â”‚   su "preprocessed_bitcoin_data"  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ModelTrainerService        â”‚
â”‚ - Consuma le sequenze da    â”‚
â”‚   "preprocessed_bitcoin_data"    â”‚
â”‚ - Addestra il modello LSTM   â”‚
â”‚ - Salva il modello e invia  â”‚
â”‚   i risultati dell'addestramento   â”‚
â”‚   su "model_training_results"      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
       (Passo facoltativo)
   [Modulo di Predictive Model]
   - Utilizza il modello addestrato per
     generare previsioni sui prezzi
   - Invia le previsioni al topic:
     "bitcoin_predictions"
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   AnalysisService           â”‚
â”‚ - Consuma previsioni dal    â”‚
â”‚   topic "bitcoin_predictions"    â”‚
â”‚ - Recupera l'ultimo prezzo  â”‚
â”‚   dal topic "bitcoin_data"   â”‚
â”‚ - Calcola segnali di tradingâ”‚
â”‚   e raccomandazioni tramite  â”‚
â”‚   la strategia (BitcoinTradingStrategy) â”‚
â”‚   (in questo esempio stampa i    â”‚
â”‚    risultati, ma in un sistema    â”‚
â”‚    operativo verrebbe inviarli a  â”‚
â”‚    un topic dedicato, es.         â”‚
â”‚    "bitcoin_trading_signals")      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   API Gateway Service       â”‚
â”‚ - Consuma segnali (da "bitcoin_trading_signals") â”‚
â”‚ - Tiene uno storico di segnali e prezzi          â”‚
â”‚ - Espone endpoint REST per:                      â”‚
â”‚    â€¢ Stato del sistema                           â”‚
â”‚    â€¢ Ultimi segnali                              â”‚
â”‚    â€¢ Cronologia dei segnali e dei prezzi         â”‚
â”‚    â€¢ Dati per la dashboard                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   TelegramNotifier Service  â”‚
â”‚ - Consuma segnali da:                           â”‚
â”‚      â€¢ "bitcoin_predictions" oppure           â”‚
â”‚      â€¢ "bitcoin_trading_signals"                â”‚
â”‚   (a seconda della versione implementata)      â”‚
â”‚ - Formattta il messaggio e invia notifiche via  â”‚
â”‚   Telegram ai canali configurati               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
